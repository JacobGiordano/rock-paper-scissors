<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <title>Rock, Paper, Scissors</title>
</head>
<body>
  <h1 class="page-title">Rock, Paper, Scissors</h1>
  <h2 id="round-counter"></h2>
  <label for="num-of-rounds">
    <input id="num-of-rounds" type="number" value=1 name="num-of-rounds" />
  </label>
  <div class="container">
    <button id="btn-rock" class="option-button">Rock</button>
    <button id="btn-paper" class="option-button">Paper</button>
    <button id="btn-scissors" class="option-button">Scissors</button>
  </div>
  <div id="results"></div>
</body>
<script>
  const optionButtons = document.querySelectorAll(".option-button");
  optionButtons.forEach(button => button.addEventListener("click", handleOptionButtonClick))

  function computerPlay() {
    const options = ["rock", "paper", "scissors"];
    let index = Math.floor(Math.random() * Math.floor(options.length));
    return options[index];
  }
  function handleOptionButtonClick(e) {
    const computerSelection = computerPlay();
    if (e.target.id === "btn-rock") {
      playRound("rock", computerSelection);
    } else if (e.target.id === "btn-paper") {
      playRound("paper", computerSelection);
    } else if (e.target.id === "btn-scissors") {
      playRound("scissors", computerSelection);
    }
  }
  function playRound(playerSelection, computerSelection) {
    let gameData = {};
    if (playerSelection === null) {
      gameData.msg = "Error. Play selection is null.";
    } else {
      playerSelection = playerSelection.toLowerCase();
    }
    computerSelection = computerSelection.toLowerCase();
    gameData.playerWon = false;
    // gameData.msg = "";
    if (playerSelection === "rock" && computerSelection === "paper") {
      gameData.playerWon = true;
    } else if (playerSelection === "paper" && computerSelection === "rock") {
      gameData.playerWon = true;
    } else if (playerSelection === "scissors" && computerSelection === "paper") {
      gameData.playerWon = true;
    } else if (playerSelection === computerSelection) {
      gameData.playerWon = "tie";
      gameData.msg = `IT'S A TIE! ${playerSelection} ${playerSelection === "scissors" ? "are" : "is"} equal to ${computerSelection}`;
      // return gameData;
    }
    gameData.msg = `${gameData.playerWon ? `YOU WIN! ${playerSelection} ${playerSelection === "scissors" ? "beat" : "beats"} ${computerSelection}` : `YOU LOSE! ${computerSelection} ${computerSelection === "scissors" ? "beat" : "beats"} ${playerSelection}`}`;

    if (document.getElementById("results").textContent == "") {
      document.getElementById("results").textContent = `${gameData.msg}`;
    } else {
      document.getElementById("results").textContent = `${gameData.msg} \n` + document.getElementById("results").textContent;
    }
    console.log(gameData);
    return gameData;
  }
  function game() {
    let numOfPlayerWins = 0;
    let numOfComputerWins = 0;
    let numOfTies = 0;
    let outcome;
    let msg;

    // let numOfRoundsToPlay = Number(prompt("Please enter the number of rounds you would like to play:"));
    // if (numOfRoundsToPlay === 0) {
    //   return;
    // }
    // else if (isNaN(numOfRoundsToPlay) || numOfRoundsToPlay === "NaN" || numOfRoundsToPlay === NaN) {
    //   alert("Whoops! Please enter a number, higher than 0, for how many rounds you would like to play:");
    //   game();
    // }

    for (let i=0; i < numOfRoundsToPlay; i++) {
      let playerSelection = getPlayerSelection(i);
        let computerSelection = computerPlay();
        outcome = playRound(playerSelection, computerSelection);
        if (outcome === undefined) {
          return;
        }
        result = outcome.playerWon;
        msg = outcome.msg;
        console.log(`-------------------- ROUND #${i + 1} --------------------
${msg}
`);
        if (result === "tie") {
          numOfTies++;
        } else if (result) {
          numOfPlayerWins++;
        } else if (!result) {
          numOfComputerWins++;
        }
    }
    console.log(`### ========================================== ###
You won: ${numOfPlayerWins} ${numOfPlayerWins > 1 ? "rounds" : "round"}
The computer won: ${numOfComputerWins} ${numOfComputerWins > 1 ? "rounds" : "round"}
And there ${numOfTies > 1 ? "were" : "was"} ${numOfTies} ${numOfTies > 1 ? "ties" : "tie"}`);
    if (numOfPlayerWins > numOfComputerWins) {
      console.log("Making *YOU* The Winner! Way to go! 🎉");
    } else if (numOfPlayerWins < numOfComputerWins) {
      console.log("The computer is the winner. Better luck next time. 👾");
    } else if (numOfPlayerWins === numOfComputerWins) {
      console.log("INCREDIBLE! It's a TIE! Well done to you *and* the computer! 👤🤝🖥");
    }
    console.log("### ========================================== ###");
  }
  // game();
</script>
</html>